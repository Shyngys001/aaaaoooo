<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS Ultimate — Premium Package Generator</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&family=Libre+Baskerville:wght@400;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-primary: #d4af37;
            --color-primary-dark: #b8941f;
            --color-secondary: #2c3e50;
            --color-text: #1a1a1a;
            --color-text-light: #6b7280;
            --color-bg: #f8f9fa;
            --color-white: #ffffff;
            --color-border: #e5e7eb;
            --color-error: #ef4444;
            --color-success: #10b981;
            
            --spacing-unit: 8px;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            
            --transition: all 0.2s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: var(--color-text);
            background: var(--color-bg);
            overflow-x: hidden;
        }
        
        /* === LAYOUT === */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        .editor-panel {
            width: 440px;
            background: var(--color-white);
            border-right: 1px solid var(--color-border);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            z-index: 100;
        }
        
        .editor-header {
            padding: calc(var(--spacing-unit) * 3);
            border-bottom: 1px solid var(--color-border);
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
            color: var(--color-white);
        }
        
        .editor-header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) / 2);
        }
        
        .editor-header p {
            font-size: 13px;
            opacity: 0.9;
        }
        
        .editor-content {
            padding: calc(var(--spacing-unit) * 3);
        }
        
        .preview-container {
            flex: 1;
            padding: calc(var(--spacing-unit) * 4);
            overflow-y: auto;
            background: linear-gradient(to bottom, #f0f0f0 0%, #e8e8e8 100%);
        }
        
        #previewSheet {
            background: var(--color-white);
            box-shadow: var(--shadow-xl);
            margin: 0 auto;
            max-width: 1200px;
        }
        
        /* === FORM SECTIONS === */
        .form-section {
            margin-bottom: calc(var(--spacing-unit) * 4);
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--color-secondary);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 1);
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(to bottom, var(--color-primary), var(--color-primary-dark));
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: calc(var(--spacing-unit) * 1);
            color: var(--color-text);
        }
        
        input[type="text"],
        input[type="number"],
        input[type="url"],
        textarea {
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 14px;
            transition: var(--transition);
        }
        
        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        /* === BUTTONS === */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: calc(var(--spacing-unit) * 1);
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 3);
            border: none;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            min-height: 44px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
            color: var(--color-white);
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: var(--color-white);
            color: var(--color-secondary);
            border: 2px solid var(--color-border);
        }
        
        .btn-secondary:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }
        
        .btn-small {
            padding: calc(var(--spacing-unit) * 1) calc(var(--spacing-unit) * 2);
            font-size: 13px;
            min-height: 36px;
        }
        
        .btn-icon {
            padding: calc(var(--spacing-unit) * 1);
            min-height: 36px;
            width: 36px;
        }
        
        .btn-delete {
            background: #fee;
            color: var(--color-error);
            border: 1px solid #fcc;
        }
        
        .btn-delete:hover {
            background: var(--color-error);
            color: white;
        }
        
        .button-group {
            display: flex;
            gap: calc(var(--spacing-unit) * 1.5);
            flex-wrap: wrap;
        }
        
        /* === LOGO UPLOAD === */
        .logo-upload {
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-unit) * 3);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .logo-upload:hover {
            border-color: var(--color-primary);
            background: rgba(212, 175, 55, 0.05);
        }
        
        .logo-preview {
            margin-top: calc(var(--spacing-unit) * 2);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 2);
            background: var(--color-bg);
            border-radius: var(--radius-sm);
        }
        
        .logo-preview img {
            max-width: 120px;
            max-height: 80px;
            object-fit: contain;
        }
        
        /* === TEMPLATE SELECTOR === */
        .template-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: calc(var(--spacing-unit) * 2);
        }
        
        .template-card {
            border: 2px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-unit) * 2);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .template-card:hover {
            border-color: var(--color-primary);
            box-shadow: var(--shadow-md);
        }
        
        .template-card.active {
            border-color: var(--color-primary);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(184, 148, 31, 0.1) 100%);
            box-shadow: var(--shadow-md);
        }
        
        .template-card h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-unit) / 2);
        }
        
        .template-card p {
            font-size: 12px;
            color: var(--color-text-light);
        }
        
        /* === DYNAMIC LISTS === */
        .list-item {
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .list-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }
        
        .list-item-title {
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: calc(var(--spacing-unit) * 1.5);
        }
        
        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: calc(var(--spacing-unit) * 1.5);
        }
        
        /* === TOAST === */
        .toast {
            position: fixed;
            top: calc(var(--spacing-unit) * 3);
            right: calc(var(--spacing-unit) * 3);
            background: var(--color-white);
            padding: calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 3);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 2);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left: 4px solid var(--color-success);
        }
        
        .toast.error {
            border-left: 4px solid var(--color-error);
        }
        
        /* === LOADING OVERLAY === */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .loading-content {
            background: var(--color-white);
            padding: calc(var(--spacing-unit) * 4);
            border-radius: var(--radius-xl);
            text-align: center;
        }
        
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--color-border);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto calc(var(--spacing-unit) * 2);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* === PRINT STYLES === */
        @media print {
            .editor-panel {
                display: none !important;
            }
            
            .preview-container {
                padding: 0;
                background: white;
            }
            
            #previewSheet {
                box-shadow: none;
                max-width: none;
            }
        }
        
        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .editor-panel {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 1px solid var(--color-border);
            }
            
            .preview-container {
                padding: calc(var(--spacing-unit) * 2);
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
            
            /* NEW: Responsive for new templates */
            .template-desert .hotels-container,
            .template-desert .services-ornate,
            .template-desert .transfer-ornate,
            .template-kazakh .services-grid-kazakh,
            .template-kazakh .transfer-grid-kazakh,
            .template-glass .hotels-glass,
            .template-glass .services-glass,
            .template-glass .transfer-glass {
                grid-template-columns: 1fr !important;
            }
            
            .template-desert .prices-grid,
            .template-kazakh .prices-grid-kazakh,
            .template-glass .prices-glass {
                grid-template-columns: 1fr !important;
            }
            
            .template-ultra .header-ultra {
                grid-template-columns: 1fr !important;
            }
            
            .template-ultra .logo-col,
            .template-ultra .brand-col,
            .template-ultra .title-col {
                grid-column: 1 / -1 !important;
                align-items: flex-start !important;
                text-align: left !important;
            }
            
            .template-ultra .section-label-ultra {
                display: none;
            }
            
            .template-ultra .section-content-ultra {
                grid-column: 1 / -1 !important;
            }
            
            .template-ultra .hotel-ultra {
                grid-template-columns: 1fr !important;
            }
            
            .template-ultra .hotel-info-ultra,
            .template-ultra .hotel-photos-ultra {
                grid-column: 1 / -1 !important;
            }
            
            .template-ultra .services-ultra,
            .template-ultra .transfer-ultra,
            .template-ultra .prices-ultra {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* === TEMPLATE STYLES === */
        
        /* Apple Minimalist */
        .template-apple {
            font-family: 'Inter', sans-serif;
            padding: calc(var(--spacing-unit) * 8);
            color: #1d1d1f;
        }
        
        .template-apple .header {
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-apple .logo {
            max-width: 200px;
            height: auto;
            margin-bottom: calc(var(--spacing-unit) * 3);
        }
        
        .template-apple .brand-name {
            font-size: 48px;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-apple .tagline {
            font-size: 18px;
            color: #86868b;
            font-weight: 400;
        }
        
        .template-apple .package-title {
            font-size: 72px;
            font-weight: 800;
            letter-spacing: -0.03em;
            margin: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 2);
            text-align: center;
        }
        
        .template-apple .package-subtitle {
            font-size: 24px;
            color: #86868b;
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 8);
        }
        
        .template-apple .section-heading {
            font-size: 36px;
            font-weight: 700;
            margin: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 4);
        }
        
        .template-apple .hotels-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-unit) * 3);
            margin-bottom: calc(var(--spacing-unit) * 8);
        }
        
        .template-apple .hotel-card {
            background: #f5f5f7;
            border-radius: calc(var(--spacing-unit) * 3);
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .template-apple .hotel-photos {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            height: 240px;
        }
        
        .template-apple .hotel-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .template-apple .hotel-info {
            padding: calc(var(--spacing-unit) * 3);
        }
        
        .template-apple .hotel-city {
            font-size: 14px;
            color: #86868b;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-apple .hotel-name {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-apple .hotel-stars {
            color: #ffb800;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-apple .hotel-meta {
            display: flex;
            gap: calc(var(--spacing-unit) * 2);
            font-size: 14px;
            color: #86868b;
        }
        
        .template-apple .prices-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
            margin-bottom: calc(var(--spacing-unit) * 8);
        }
        
        .template-apple .price-card {
            background: #f5f5f7;
            border-radius: calc(var(--spacing-unit) * 3);
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
        }
        
        .template-apple .price-label {
            font-size: 16px;
            color: #86868b;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-apple .price-value {
            font-size: 48px;
            font-weight: 800;
            letter-spacing: -0.02em;
        }
        
        .template-apple .services-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-apple .service-card {
            background: #f5f5f7;
            border-radius: calc(var(--spacing-unit) * 3);
            padding: calc(var(--spacing-unit) * 3);
            text-align: center;
        }
        
        .template-apple .service-icon {
            font-size: 48px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-apple .service-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-apple .service-desc {
            font-size: 14px;
            color: #86868b;
        }
        
        /* Magazine Editorial */
        .template-magazine {
            font-family: 'Libre Baskerville', serif;
            background: white;
        }
        
        .template-magazine .hero {
            position: relative;
            height: 600px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: calc(var(--spacing-unit) * 6);
        }
        
        .template-magazine .hero-content {
            position: relative;
            z-index: 2;
        }
        
        .template-magazine .hero .logo {
            max-width: 180px;
            margin-bottom: calc(var(--spacing-unit) * 3);
            filter: brightness(0) invert(1);
        }
        
        .template-magazine .hero .brand-name {
            font-size: 64px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
            letter-spacing: 0.02em;
        }
        
        .template-magazine .hero .package-title {
            font-size: 56px;
            font-weight: 400;
            font-style: italic;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-magazine .hero .tagline {
            font-size: 18px;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            opacity: 0.8;
        }
        
        .template-magazine .content {
            max-width: 1200px;
            margin: 0 auto;
            padding: calc(var(--spacing-unit) * 8);
        }
        
        .template-magazine .section-title {
            font-size: 48px;
            font-weight: 700;
            margin: calc(var(--spacing-unit) * 8) 0 calc(var(--spacing-unit) * 6);
            text-align: center;
            position: relative;
        }
        
        .template-magazine .section-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: var(--color-primary);
            margin: calc(var(--spacing-unit) * 3) auto 0;
        }
        
        .template-magazine .hotel-feature {
            margin-bottom: calc(var(--spacing-unit) * 8);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: calc(var(--spacing-unit) * 4);
            align-items: center;
        }
        
        .template-magazine .hotel-feature:nth-child(even) {
            direction: rtl;
        }
        
        .template-magazine .hotel-feature:nth-child(even) > * {
            direction: ltr;
        }
        
        .template-magazine .hotel-images {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-unit) * 2);
        }
        
        .template-magazine .hotel-images img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .template-magazine .hotel-images img:first-child {
            grid-column: 1 / -1;
            height: 350px;
        }
        
        .template-magazine .hotel-details h3 {
            font-size: 36px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-magazine .hotel-city-tag {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-primary);
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-magazine .hotel-meta-row {
            display: flex;
            gap: calc(var(--spacing-unit) * 3);
            margin: calc(var(--spacing-unit) * 2) 0;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
        }
        
        .template-magazine .prices-showcase {
            background: #f9f9f9;
            padding: calc(var(--spacing-unit) * 8);
            margin: calc(var(--spacing-unit) * 8) calc(var(--spacing-unit) * -8);
        }
        
        .template-magazine .prices-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .template-magazine .price-box {
            text-align: center;
            padding: calc(var(--spacing-unit) * 4);
            background: white;
            border: 2px solid #e0e0e0;
        }
        
        .template-magazine .price-box .label {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-magazine .price-box .value {
            font-size: 42px;
            font-weight: 700;
            color: var(--color-primary);
        }
        
        .template-magazine .services-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
            margin-top: calc(var(--spacing-unit) * 6);
        }
        
        .template-magazine .service-item {
            text-align: center;
        }
        
        .template-magazine .service-item .icon {
            font-size: 56px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-magazine .service-item h4 {
            font-size: 20px;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-magazine .service-item p {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            color: #666;
        }
        
        /* Brutalist Luxury */
        .template-brutalist {
            font-family: 'Space Grotesk', sans-serif;
            background: #000000;
            color: #ffffff;
            padding: 0;
        }
        
        .template-brutalist .header-block {
            background: #000;
            border: 8px solid #fff;
            padding: calc(var(--spacing-unit) * 8);
            text-align: center;
            margin: calc(var(--spacing-unit) * 4);
        }
        
        .template-brutalist .logo {
            max-width: 200px;
            margin-bottom: calc(var(--spacing-unit) * 3);
            filter: brightness(0) invert(1);
        }
        
        .template-brutalist .brand-name {
            font-size: 80px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-brutalist .tagline {
            font-size: 16px;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--color-primary);
        }
        
        .template-brutalist .title-block {
            background: var(--color-primary);
            color: #000;
            padding: calc(var(--spacing-unit) * 10) calc(var(--spacing-unit) * 4);
            text-align: center;
            margin: calc(var(--spacing-unit) * 4);
            border: 8px solid #fff;
        }
        
        .template-brutalist .package-title {
            font-size: 96px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            line-height: 0.9;
        }
        
        .template-brutalist .package-subtitle {
            font-size: 28px;
            margin-top: calc(var(--spacing-unit) * 3);
            font-weight: 300;
        }
        
        .template-brutalist .content-wrapper {
            padding: calc(var(--spacing-unit) * 4);
        }
        
        .template-brutalist .section-header {
            font-size: 56px;
            font-weight: 700;
            text-transform: uppercase;
            margin: calc(var(--spacing-unit) * 8) 0 calc(var(--spacing-unit) * 4);
            padding-left: calc(var(--spacing-unit) * 2);
            border-left: 8px solid var(--color-primary);
        }
        
        .template-brutalist .hotels-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-brutalist .hotel-block {
            border: 4px solid #fff;
            background: #1a1a1a;
        }
        
        .template-brutalist .hotel-photos-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            height: 280px;
        }
        
        .template-brutalist .hotel-photos-grid img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-right: 2px solid #000;
        }
        
        .template-brutalist .hotel-photos-grid img:last-child {
            border-right: none;
        }
        
        .template-brutalist .hotel-content {
            padding: calc(var(--spacing-unit) * 3);
        }
        
        .template-brutalist .hotel-city-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-primary);
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-brutalist .hotel-name {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-brutalist .hotel-stats {
            display: flex;
            gap: calc(var(--spacing-unit) * 3);
            font-size: 14px;
        }
        
        .template-brutalist .stat {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 1);
        }
        
        .template-brutalist .prices-section {
            background: #fff;
            color: #000;
            padding: calc(var(--spacing-unit) * 8) calc(var(--spacing-unit) * 4);
            margin: calc(var(--spacing-unit) * 8) calc(var(--spacing-unit) * 4);
            border: 8px solid #000;
        }
        
        .template-brutalist .prices-section .section-header {
            color: #000;
            border-left-color: #000;
        }
        
        .template-brutalist .prices-flex {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-brutalist .price-block {
            border: 4px solid #000;
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
            background: var(--color-primary);
        }
        
        .template-brutalist .price-block .label {
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: calc(var(--spacing-unit) * 2);
            font-weight: 700;
        }
        
        .template-brutalist .price-block .value {
            font-size: 56px;
            font-weight: 700;
        }
        
        .template-brutalist .services-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-brutalist .service-block {
            border: 4px solid #fff;
            padding: calc(var(--spacing-unit) * 4);
            background: #1a1a1a;
            text-align: center;
        }
        
        .template-brutalist .service-block .icon {
            font-size: 64px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-brutalist .service-block h4 {
            font-size: 24px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-brutalist .service-block p {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Swiss Modern */
        .template-swiss {
            font-family: 'Space Grotesk', sans-serif;
            background: white;
            padding: 0;
        }
        
        .template-swiss .header-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            min-height: 400px;
        }
        
        .template-swiss .header-left {
            background: #000;
            color: #fff;
            padding: calc(var(--spacing-unit) * 6);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .template-swiss .logo {
            max-width: 160px;
            margin-bottom: calc(var(--spacing-unit) * 4);
            filter: brightness(0) invert(1);
        }
        
        .template-swiss .brand-name {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-swiss .tagline {
            font-size: 14px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        
        .template-swiss .header-right {
            background: #ffa742;
            color: #fff;
            padding: calc(var(--spacing-unit) * 6);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .template-swiss .package-title {
            font-size: 84px;
            font-weight: 700;
            line-height: 0.9;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-swiss .package-subtitle {
            font-size: 20px;
            font-weight: 300;
        }
        
        .template-swiss .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: calc(var(--spacing-unit) * 8);
        }
        
        .template-swiss .section-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #ffa742;
            margin-bottom: calc(var(--spacing-unit) * 2);
            font-weight: 700;
        }
        
        .template-swiss .section-title {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 6);
            color: #000;
        }
        
        .template-swiss .hotels-list {
            display: grid;
            gap: calc(var(--spacing-unit) * 6);
        }
        
        .template-swiss .hotel-row {
            display: grid;
            grid-template-columns: 2fr 3fr;
            gap: calc(var(--spacing-unit) * 4);
            border-bottom: 2px solid #000;
            padding-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-swiss .hotel-info-col h3 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-swiss .hotel-city-tag {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #ffa742;
            margin-bottom: calc(var(--spacing-unit) * 1);
            font-weight: 700;
        }
        
        .template-swiss .hotel-meta-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            margin-top: calc(var(--spacing-unit) * 3);
        }
        
        .template-swiss .meta-item {
            font-size: 14px;
        }
        
        .template-swiss .meta-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #999;
            margin-bottom: calc(var(--spacing-unit) * 0.5);
        }
        
        .template-swiss .meta-value {
            font-weight: 600;
        }
        
        .template-swiss .hotel-images-stack {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
        }
        
        .template-swiss .hotel-images-stack img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        
        .template-swiss .prices-module {
            background: #000;
            color: #fff;
            padding: calc(var(--spacing-unit) * 8);
            margin: calc(var(--spacing-unit) * 8) 0;
        }
        
        .template-swiss .prices-module .section-label {
            color: #ffa742;
        }
        
        .template-swiss .prices-module .section-title {
            color: #fff;
        }
        
        .template-swiss .prices-table {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-swiss .price-cell {
            border: 2px solid #ffa742;
            border-radius: 10px;
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
        }
        
        .template-swiss .price-cell .label {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-swiss .price-cell .value {
            font-size: 48px;
            font-weight: 700;
            color: #ffa742;
        }
        
        .template-swiss .services-matrix {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-swiss .service-cell {
            border: 2px solid #000;
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
        }
        
        .template-swiss .service-cell .icon {
            font-size: 56px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-swiss .service-cell h4 {
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-swiss .service-cell p {
            font-size: 14px;
            color: #666;
        }
        
        /* === NEW: Desert Classic === */
        .template-desert {
            font-family: 'Libre Baskerville', serif;
            background: linear-gradient(to bottom, #f5e6d3 0%, #e8d4b8 100%);
            padding: calc(var(--spacing-unit) * 8);
        }
        
        .template-desert .header-ornate {
            background: linear-gradient(135deg, #8b7355 0%, #6b5744 100%);
            color: #f5e6d3;
            padding: calc(var(--spacing-unit) * 8);
            text-align: center;
            border: 4px solid #d4af37;
            border-radius: calc(var(--spacing-unit) * 2);
            box-shadow: 0 8px 32px rgba(139, 115, 85, 0.3);
            position: relative;
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-desert .header-ornate::before,
        .template-desert .header-ornate::after {
            content: '◆◆◆';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            color: #d4af37;
            font-size: 20px;
            letter-spacing: 12px;
        }
        
        .template-desert .header-ornate::before {
            top: calc(var(--spacing-unit) * 2);
        }
        
        .template-desert .header-ornate::after {
            bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-desert .logo {
            max-width: 180px;
            margin-bottom: calc(var(--spacing-unit) * 3);
            filter: brightness(0) invert(1) sepia(1) saturate(5) hue-rotate(15deg);
        }
        
        .template-desert .brand-name {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .template-desert .package-title {
            font-size: 64px;
            font-weight: 700;
            color: #8b7355;
            text-align: center;
            margin: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 2);
            text-shadow: 2px 2px 0 rgba(212, 175, 55, 0.3);
        }
        
        .template-desert .package-subtitle {
            font-size: 24px;
            color: #6b5744;
            text-align: center;
            font-style: italic;
            margin-bottom: calc(var(--spacing-unit) * 8);
        }
        
        .template-desert .section-divider {
            text-align: center;
            margin: calc(var(--spacing-unit) * 6) 0;
            color: #d4af37;
            font-size: 32px;
            letter-spacing: 16px;
        }
        
        .template-desert .section-heading {
            font-size: 42px;
            font-weight: 700;
            color: #6b5744;
            text-align: center;
            margin: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 4);
        }
        
        .template-desert .hotels-container {
            display: grid;
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-desert .hotel-ornate {
            background: white;
            border: 3px solid #d4af37;
            border-radius: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 4);
            box-shadow: 0 8px 24px rgba(107, 87, 68, 0.2);
        }
        
        .template-desert .hotel-header {
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 3);
            padding-bottom: calc(var(--spacing-unit) * 2);
            border-bottom: 2px solid #f5e6d3;
        }
        
        .template-desert .hotel-city-ornate {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: #d4af37;
            font-family: 'Inter', sans-serif;
        }
        
        .template-desert .hotel-name {
            font-size: 36px;
            font-weight: 700;
            color: #6b5744;
            margin: calc(var(--spacing-unit) * 1) 0;
        }
        
        .template-desert .hotel-photos-ornate {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 3);
        }
        
        .template-desert .hotel-photos-ornate img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            border-radius: var(--radius-md);
            border: 2px solid #d4af37;
        }
        
        .template-desert .hotel-meta-ornate {
            display: flex;
            justify-content: center;
            gap: calc(var(--spacing-unit) * 4);
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            color: #6b5744;
        }
        
        .template-desert .prices-ornate {
            background: white;
            border: 3px solid #d4af37;
            border-radius: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 6);
            margin: calc(var(--spacing-unit) * 6) 0;
        }
        
        .template-desert .prices-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-desert .price-ornate {
            text-align: center;
            padding: calc(var(--spacing-unit) * 4);
            background: linear-gradient(135deg, #f5e6d3 0%, #e8d4b8 100%);
            border-radius: var(--radius-md);
            border: 2px solid #d4af37;
        }
        
        .template-desert .price-ornate .label {
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            color: #6b5744;
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .template-desert .price-ornate .value {
            font-size: 48px;
            font-weight: 700;
            color: #8b7355;
        }
        
        .template-desert .services-ornate,
        .template-desert .transfer-ornate {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-desert .service-box,
        .template-desert .transfer-box {
            background: white;
            border: 2px solid #d4af37;
            border-radius: var(--radius-md);
            padding: calc(var(--spacing-unit) * 3);
            text-align: center;
        }
        
        .template-desert .service-box .icon,
        .template-desert .transfer-box .icon {
            font-size: 56px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-desert .service-box h4,
        .template-desert .transfer-box h4 {
            font-size: 18px;
            font-weight: 700;
            color: #6b5744;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-desert .service-box p,
        .template-desert .transfer-box p {
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            color: #8b7355;
        }
        
        /* === NEW: Kazakh Ornate === */
        .template-kazakh {
            font-family: 'Playfair Display', serif;
            background: linear-gradient(to bottom, #001f3f 0%, #003366 100%);
            color: white;
            padding: 0;
        }
        
        .template-kazakh .hero-kazakh {
            background: linear-gradient(135deg, #003366 0%, #004080 100%);
            padding: calc(var(--spacing-unit) * 10);
            text-align: center;
            position: relative;
            border-bottom: 6px solid #d4af37;
        }
        
        .template-kazakh .ornament-top {
            font-size: 48px;
            color: #d4af37;
            margin-bottom: calc(var(--spacing-unit) * 3);
            letter-spacing: 8px;
        }
        
        .template-kazakh .logo {
            max-width: 200px;
            margin-bottom: calc(var(--spacing-unit) * 4);
            filter: brightness(0) invert(1);
        }
        
        .template-kazakh .brand-name {
            font-size: 72px;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        
        .template-kazakh .tagline {
            font-size: 18px;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.8);
        }
        
        .template-kazakh .title-section {
            background: #d4af37;
            color: #001f3f;
            padding: calc(var(--spacing-unit) * 12) calc(var(--spacing-unit) * 6);
            text-align: center;
        }
        
        .template-kazakh .package-title {
            font-size: 96px;
            font-weight: 700;
            line-height: 0.9;
            margin-bottom: calc(var(--spacing-unit) * 3);
        }
        
        .template-kazakh .package-subtitle {
            font-size: 32px;
            font-weight: 400;
        }
        
        .template-kazakh .content-kazakh {
            max-width: 1400px;
            margin: 0 auto;
            padding: calc(var(--spacing-unit) * 8);
        }
        
        .template-kazakh .ornament-divider {
            text-align: center;
            font-size: 36px;
            color: #d4af37;
            margin: calc(var(--spacing-unit) * 8) 0;
            letter-spacing: 12px;
        }
        
        .template-kazakh .section-title-kazakh {
            font-size: 56px;
            font-weight: 700;
            color: #d4af37;
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 6);
            position: relative;
        }
        
        .template-kazakh .section-title-kazakh::after {
            content: '◆◆◆';
            display: block;
            color: rgba(212, 175, 55, 0.4);
            font-size: 24px;
            margin-top: calc(var(--spacing-unit) * 2);
            letter-spacing: 16px;
        }
        
        .template-kazakh .hotels-kazakh {
            display: grid;
            gap: calc(var(--spacing-unit) * 6);
        }
        
        .template-kazakh .hotel-kazakh {
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid #d4af37;
            border-radius: calc(var(--spacing-unit) * 3);
            overflow: hidden;
        }
        
        .template-kazakh .hotel-kazakh-header {
            background: #d4af37;
            color: #001f3f;
            padding: calc(var(--spacing-unit) * 3);
            text-align: center;
        }
        
        .template-kazakh .hotel-city-kazakh {
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.3em;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-kazakh .hotel-name-kazakh {
            font-size: 42px;
            font-weight: 700;
        }
        
        .template-kazakh .hotel-body {
            padding: calc(var(--spacing-unit) * 4);
        }
        
        .template-kazakh .hotel-photos-kazakh {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 3);
        }
        
        .template-kazakh .hotel-photos-kazakh img {
            width: 100%;
            height: 260px;
            object-fit: cover;
            border-radius: var(--radius-md);
            border: 2px solid rgba(212, 175, 55, 0.3);
        }
        
        .template-kazakh .hotel-meta-kazakh {
            display: flex;
            justify-content: center;
            gap: calc(var(--spacing-unit) * 4);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
        }
        
        .template-kazakh .prices-kazakh {
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            color: #001f3f;
            padding: calc(var(--spacing-unit) * 8);
            margin: calc(var(--spacing-unit) * 8) 0;
            border-radius: calc(var(--spacing-unit) * 3);
        }
        
        .template-kazakh .prices-kazakh .section-title-kazakh {
            color: #001f3f;
        }
        
        .template-kazakh .prices-kazakh .section-title-kazakh::after {
            color: rgba(0, 31, 63, 0.3);
        }
        
        .template-kazakh .prices-grid-kazakh {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-kazakh .price-kazakh {
            background: #001f3f;
            color: white;
            border: 3px solid #003366;
            padding: calc(var(--spacing-unit) * 5);
            text-align: center;
            border-radius: var(--radius-lg);
        }
        
        .template-kazakh .price-kazakh .label {
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: #d4af37;
        }
        
        .template-kazakh .price-kazakh .value {
            font-size: 56px;
            font-weight: 700;
        }
        
        .template-kazakh .services-grid-kazakh,
        .template-kazakh .transfer-grid-kazakh {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-kazakh .service-kazakh,
        .template-kazakh .transfer-kazakh {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.5);
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
            border-radius: var(--radius-lg);
        }
        
        .template-kazakh .service-kazakh .icon,
        .template-kazakh .transfer-kazakh .icon {
            font-size: 64px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-kazakh .service-kazakh h4,
        .template-kazakh .transfer-kazakh h4 {
            font-size: 22px;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-kazakh .service-kazakh p,
        .template-kazakh .transfer-kazakh p {
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            color: rgba(255,255,255,0.8);
        }
        
        /* === NEW: Ultra Modern Grid === */
        .template-ultra {
            font-family: 'Space Grotesk', sans-serif;
            background: white;
            padding: 0;
        }
        
        .template-ultra .grid-container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 4);
        }
        
        .template-ultra .header-ultra {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 6) 0;
            border-bottom: 1px solid #000;
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-ultra .logo-col {
            grid-column: 1 / 4;
            display: flex;
            align-items: center;
        }
        
        .template-ultra .logo {
            max-width: 140px;
        }
        
        .template-ultra .brand-col {
            grid-column: 4 / 8;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .template-ultra .brand-name {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .tagline {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #666;
        }
        
        .template-ultra .title-col {
            grid-column: 8 / -1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-end;
            text-align: right;
        }
        
        .template-ultra .package-title {
            font-size: 56px;
            font-weight: 700;
            line-height: 1;
        }
        
        .template-ultra .package-subtitle {
            font-size: 16px;
            color: #666;
            margin-top: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .section-label-ultra {
            grid-column: 1 / 3;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 2px solid #000;
            font-weight: 700;
        }
        
        .template-ultra .section-content-ultra {
            grid-column: 3 / -1;
        }
        
        .template-ultra .section-title-ultra {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 4);
            border-bottom: 2px solid #000;
            padding-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .hotels-ultra {
            display: grid;
            gap: calc(var(--spacing-unit) * 4);
        }
        
        .template-ultra .hotel-ultra {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            border: 1px solid #ddd;
            padding: calc(var(--spacing-unit) * 3);
        }
        
        .template-ultra .hotel-info-ultra {
            grid-column: 1 / 5;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .template-ultra .hotel-city-ultra {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: #999;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .hotel-name-ultra {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .hotel-stats-ultra {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
            font-size: 12px;
        }
        
        .template-ultra .stat-ultra {
            border-left: 2px solid #000;
            padding-left: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .stat-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #999;
            display: block;
        }
        
        .template-ultra .stat-value {
            font-weight: 700;
            font-size: 14px;
        }
        
        .template-ultra .hotel-photos-ultra {
            grid-column: 5 / -1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .hotel-photos-ultra img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border: 1px solid #ddd;
        }
        
        .template-ultra .prices-ultra {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .price-ultra {
            border: 2px solid #000;
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
        }
        
        .template-ultra .price-ultra .label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .price-ultra .value {
            font-size: 48px;
            font-weight: 700;
        }
        
        .template-ultra .services-ultra,
        .template-ultra .transfer-ultra {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .service-ultra,
        .template-ultra .transfer-item-ultra {
            border: 1px solid #ddd;
            padding: calc(var(--spacing-unit) * 3);
            text-align: center;
        }
        
        .template-ultra .service-ultra .icon,
        .template-ultra .transfer-item-ultra .icon {
            font-size: 48px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-ultra .service-ultra h4,
        .template-ultra .transfer-item-ultra h4 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-ultra .service-ultra p,
        .template-ultra .transfer-item-ultra p {
            font-size: 13px;
            color: #666;
        }
        
        /* === NEW: Apple Glassmorphism === */
        .template-glass {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #ffd08a 0%, #000000 50%, #111010 100%);
            padding: calc(var(--spacing-unit) * 8);
            min-height: 100vh;
        }
        
        .template-glass .glass-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: calc(var(--spacing-unit) * 4);
            padding: calc(var(--spacing-unit) * 6);
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 6);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .template-glass .logo {
            max-width: 180px;
            margin-bottom: calc(var(--spacing-unit) * 3);
            filter: brightness(0) invert(1);
        }
        
        .template-glass .brand-name {
            font-size: 64px;
            font-weight: 800;
            color: white;
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
        }
        
        .template-glass .tagline {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        
        .template-glass .glass-title {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: calc(var(--spacing-unit) * 4);
            padding: calc(var(--spacing-unit) * 8);
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-glass .package-title {
            font-size: 80px;
            font-weight: 800;
            color: white;
            line-height: 1;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-glass .package-subtitle {
            font-size: 24px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .template-glass .section-heading-glass {
            font-size: 48px;
            font-weight: 700;
            color: white;
            text-align: center;
            margin: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 4);
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
        }
        
        .template-glass .hotels-glass {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-unit) * 4);
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-glass .hotel-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: calc(var(--spacing-unit) * 3);
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .template-glass .hotel-photos-glass {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            height: 250px;
        }
        
        .template-glass .hotel-photos-glass img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .template-glass .hotel-info-glass {
            padding: calc(var(--spacing-unit) * 4);
            color: white;
        }
        
        .template-glass .hotel-city-glass {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-glass .hotel-name-glass {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-glass .hotel-meta-glass {
            display: flex;
            gap: calc(var(--spacing-unit) * 2);
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .template-glass .prices-glass {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
            margin-bottom: calc(var(--spacing-unit) * 6);
        }
        
        .template-glass .price-glass {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: calc(var(--spacing-unit) * 3);
            padding: calc(var(--spacing-unit) * 5);
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .template-glass .price-glass .label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .template-glass .price-glass .value {
            font-size: 52px;
            font-weight: 800;
            color: white;
        }
        
        .template-glass .services-glass,
        .template-glass .transfer-glass {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: calc(var(--spacing-unit) * 3);
        }
        
        .template-glass .service-glass,
        .template-glass .transfer-item-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: calc(var(--spacing-unit) * 3);
            padding: calc(var(--spacing-unit) * 4);
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .template-glass .service-glass .icon,
        .template-glass .transfer-item-glass .icon {
            font-size: 56px;
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        
        .template-glass .service-glass h4,
        .template-glass .transfer-item-glass h4 {
            font-size: 20px;
            font-weight: 600;
            color: white;
            margin-bottom: calc(var(--spacing-unit) * 1);
        }
        
        .template-glass .service-glass p,
        .template-glass .transfer-item-glass p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Editor Panel -->
        <aside class="editor-panel">
            <div class="editor-header">
                <h1>ATLAS Ultimate</h1>
                <p>Premium Package Generator</p>
            </div>
            
            <div class="editor-content">
                <!-- Branding -->
                <section class="form-section">
                    <h3 class="section-title">Брендинг</h3>
                    
                    <div class="form-group">
                        <label>Логотип</label>
                        <div class="logo-upload" id="logoUpload">
                            <div>📷 Загрузить логотип</div>
                            <small style="color: var(--color-text-light); margin-top: 8px; display: block;">JPG, PNG до 2MB</small>
                        </div>
                        <input type="file" id="logoInput" accept="image/*" style="display: none;">
                        <div id="logoPreview" style="display: none;" class="logo-preview">
                            <img id="logoPreviewImg" alt="Logo">
                            <button class="btn btn-small btn-delete" id="logoRemove">Удалить</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Название бренда</label>
                        <input type="text" id="brandName" placeholder="ATLAS">
                    </div>
                    
                    <div class="form-group">
                        <label>Слоган</label>
                        <input type="text" id="tagline" placeholder="Premium Travel Services">
                    </div>
                </section>
                
                <!-- Package Info -->
                <section class="form-section">
                    <h3 class="section-title">Информация о пакете</h3>
                    
                    <div class="form-group">
                        <label>Название пакета</label>
                        <input type="text" id="packageTitle" placeholder="Umrah 2025">
                    </div>
                    
                    <div class="form-group">
                        <label>Подзаголовок</label>
                        <input type="text" id="packageSubtitle" placeholder="Священное путешествие">
                    </div>
                </section>
                
                <!-- Template Selector -->
                <section class="form-section">
                    <h3 class="section-title">Шаблон</h3>
                    <div class="template-grid" id="templateSelector">
                        <div class="template-card active" data-template="apple-minimalist">
                            <h4>Apple Minimalist</h4>
                            <p>Крупная типографика</p>
                        </div>
                        <div class="template-card" data-template="magazine-editorial">
                            <h4>Magazine Editorial</h4>
                            <p>Журнальная верстка</p>
                        </div>
                        <div class="template-card" data-template="brutalist-luxury">
                            <h4>Brutalist Luxury</h4>
                            <p>Тёмная контрастная</p>
                        </div>
                        <div class="template-card" data-template="swiss-modern">
                            <h4>Swiss Modern</h4>
                            <p>Швейцарская сетка</p>
                        </div>
                        <!-- NEW: 4 additional templates -->
                        <div class="template-card" data-template="desert-classic">
                            <h4>Desert Classic</h4>
                            <p>Восточные узоры</p>
                        </div>
                        <div class="template-card" data-template="kazakh-ornate">
                            <h4>Kazakh Ornate</h4>
                            <p>Золото и орнаменты</p>
                        </div>
                        <div class="template-card" data-template="ultra-modern-grid">
                            <h4>Ultra Modern Grid</h4>
                            <p>12-колоночная сетка</p>
                        </div>
                        <div class="template-card" data-template="apple-glassmorphism">
                            <h4>Apple Glassmorphism</h4>
                            <p>Стеклянные панели</p>
                        </div>
                    </div>
                </section>
                
                <!-- Hotels -->
                <section class="form-section">
                    <h3 class="section-title">Отели</h3>
                    <div id="hotelsList"></div>
                    <button class="btn btn-secondary btn-small" id="addHotel">+ Добавить отель</button>
                </section>
                
                <!-- Prices -->
                <section class="form-section">
                    <h3 class="section-title">Цены</h3>
                    <div id="pricesList"></div>
                    <button class="btn btn-secondary btn-small" id="addPrice">+ Добавить цену</button>
                </section>
                
                <!-- Services -->
                <section class="form-section">
                    <h3 class="section-title">Услуги</h3>
                    <div id="servicesList"></div>
                    <button class="btn btn-secondary btn-small" id="addService">+ Добавить услугу</button>
                </section>
                
                <!-- NEW: Transfer Section -->
                <section class="form-section" style="display: none;">
                    <h3 class="section-title">🚐 Трансфер и Гид</h3>
                    <div id="transferList"></div>
                    <button class="btn btn-secondary btn-small" id="addTransfer">+ Добавить</button>
                </section>
                
                <!-- Actions -->
                <section class="form-section">
                    <h3 class="section-title">Действия</h3>
                    <div class="button-group">
                        <button class="btn btn-primary" id="exportPDF">📄 Экспорт PDF</button>
                        <button class="btn btn-secondary" id="printBtn">🖨️ Печать</button>
                    </div>
                    <div class="button-group" style="margin-top: 16px;">
                        <button class="btn btn-secondary btn-small" id="saveJSON">💾 Сохранить</button>
                        <button class="btn btn-secondary btn-small" id="loadJSON">📂 Загрузить</button>
                    </div>
                    <input type="file" id="jsonInput" accept=".json" style="display: none;">
                </section>
            </div>
        </aside>
        
        <!-- Preview Area -->
        <main class="preview-container">
            <div id="previewSheet"></div>
        </main>
    </div>
    
    <!-- Toast -->
    <div id="toast" class="toast"></div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3>Создание PDF...</h3>
            <p>Пожалуйста, подождите</p>
        </div>
    </div>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    
    <script>
        // === STATE MANAGEMENT ===
        let state = {
            template: 'apple-minimalist',
            logo: null,
            brandName: 'ATLAS',
            tagline: 'Premium Travel Services',
            packageTitle: 'Umrah 2025',
            packageSubtitle: 'Священное путешествие',
            hotels: [
                {
                    city: 'Мекка',
                    name: 'Swissôtel Makkah',
                    stars: 5,
                    rating: 9.2,
                    distance: '300м от Харама',
                    photos: [
                        'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800',
                        'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800',
                        'https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?w=800'
                    ]
                },
                {
                    city: 'Медина',
                    name: 'Mövenpick Hotel',
                    stars: 5,
                    rating: 9.3,
                    distance: '200м от мечети',
                    photos: [
                        'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?w=800',
                        'https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=800',
                        'https://images.unsplash.com/photo-1445019980597-93fa8acb246c?w=800'
                    ]
                }
            ],
            prices: [
                { label: '4-местный', value: '$1,500' },
                { label: '3-местный', value: '$1,800' },
                { label: '2-местный', value: '$2,200' }
            ],
            services: [
                { icon: '✈️', title: 'Виза', desc: 'Полное оформление' },
                { icon: '🏨', title: 'Отели 5★', desc: 'Премиум размещение' },
                { icon: '🚌', title: 'Трансфер', desc: 'Комфортабельный транспорт' },
                { icon: '🍽️', title: 'Питание', desc: 'Завтраки включены' },
                { icon: '📱', title: 'Поддержка 24/7', desc: 'Русскоязычный гид' },
                { icon: '🎫', title: 'Экскурсии', desc: 'Обзорные туры' }
            ],
            // NEW: Transfer and Guide section
            transfer: [
                { icon: '🚌', title: 'Трансфер аэропорт–отель', desc: 'Mercedes Sprinter, климат-контроль' },
                { icon: '👤', title: 'Гид', desc: 'Русскоязычный, сопровождает всю поездку' }
            ]
        };
        
        // === UTILITY FUNCTIONS ===
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        function sanitizeUrl(url) {
            if (!url) return '';
            try {
                new URL(url);
                return url + (url.includes('unsplash') ? '&w=800' : '');
            } catch {
                return '';
            }
        }
        
        function getStars(count) {
            return '⭐'.repeat(count);
        }
        
        // === RENDER TEMPLATES ===
        function renderAppleMinimalist() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" class="hotel-photo" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-card">
                        <div class="hotel-photos">
                            ${photoHtml || '<div style="background: #e0e0e0; grid-column: 1/-1;"></div>'}
                        </div>
                        <div class="hotel-info">
                            <div class="hotel-city">${hotel.city}</div>
                            <h3 class="hotel-name">${hotel.name}</h3>
                            <div class="hotel-stars">${getStars(hotel.stars)}</div>
                            <div class="hotel-meta">
                                <span>⭐ ${hotel.rating}</span>
                                <span>📍 ${hotel.distance}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-card">
                    <div class="price-label">${price.label}</div>
                    <div class="price-value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-card">
                    <div class="service-icon">${service.icon}</div>
                    <div class="service-title">${service.title}</div>
                    <div class="service-desc">${service.desc}</div>
                </div>
            `).join('');
            
            return `
                <div class="template-apple">
                    <div class="header">
                        ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                        <h1 class="brand-name">${state.brandName}</h1>
                        <p class="tagline">${state.tagline}</p>
                    </div>
                    
                    <h2 class="package-title">${state.packageTitle}</h2>
                    <p class="package-subtitle">${state.packageSubtitle}</p>
                    
                    <h3 class="section-heading">Отели</h3>
                    <div class="hotels-grid">${hotels}</div>
                    
                    <h3 class="section-heading">Цены</h3>
                    <div class="prices-grid">${prices}</div>
                    
                    <h3 class="section-heading">Что включено</h3>
                    <div class="services-grid">${services}</div>
                </div>
            `;
        }
        
        function renderMagazineEditorial() {
            const hotels = state.hotels.map((hotel, idx) => {
                const photoHtml = hotel.photos.slice(0, 3).map((url, i) => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-feature">
                        <div class="hotel-images">
                            ${photoHtml || '<div style="background: #ddd; grid-column: 1/-1; height: 350px;"></div>'}
                        </div>
                        <div class="hotel-details">
                            <div class="hotel-city-tag">${hotel.city}</div>
                            <h3>${hotel.name}</h3>
                            <div class="hotel-meta-row">
                                <span>${getStars(hotel.stars)}</span>
                                <span>Рейтинг ${hotel.rating}/10</span>
                            </div>
                            <p style="margin-top: 16px; font-family: Inter, sans-serif; color: #666;">
                                📍 ${hotel.distance}
                            </p>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-box">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-item">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-magazine">
                    <div class="hero">
                        <div class="hero-content">
                            ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                            <h1 class="brand-name">${state.brandName}</h1>
                            <h2 class="package-title">${state.packageTitle}</h2>
                            <p class="tagline">${state.tagline}</p>
                        </div>
                    </div>
                    
                    <div class="content">
                        <h2 class="section-title">Размещение</h2>
                        ${hotels}
                        
                        <div class="prices-showcase">
                            <h2 class="section-title">Стоимость</h2>
                            <div class="prices-row">${prices}</div>
                        </div>
                        
                        <h2 class="section-title">Включенные услуги</h2>
                        <div class="services-columns">${services}</div>
                    </div>
                </div>
            `;
        }
        
        function renderBrutalistLuxury() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-block">
                        <div class="hotel-photos-grid">
                            ${photoHtml || '<div style="background: #333; grid-column: 1/-1;"></div>'}
                        </div>
                        <div class="hotel-content">
                            <div class="hotel-city-label">${hotel.city}</div>
                            <h3 class="hotel-name">${hotel.name}</h3>
                            <div class="hotel-stats">
                                <div class="stat">${getStars(hotel.stars)}</div>
                                <div class="stat">⭐ ${hotel.rating}</div>
                                <div class="stat">📍 ${hotel.distance}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-block">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-block">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-brutalist">
                    <div class="header-block">
                        ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                        <h1 class="brand-name">${state.brandName}</h1>
                        <p class="tagline">${state.tagline}</p>
                    </div>
                    
                    <div class="title-block">
                        <h2 class="package-title">${state.packageTitle}</h2>
                        <p class="package-subtitle">${state.packageSubtitle}</p>
                    </div>
                    
                    <div class="content-wrapper">
                        <h3 class="section-header">Hotels</h3>
                        <div class="hotels-grid">${hotels}</div>
                        
                        <div class="prices-section">
                            <h3 class="section-header">Pricing</h3>
                            <div class="prices-flex">${prices}</div>
                        </div>
                        
                        <h3 class="section-header">Services</h3>
                        <div class="services-grid">${services}</div>
                    </div>
                </div>
            `;
        }
        
        function renderSwissModern() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-row">
                        <div class="hotel-info-col">
                            <div class="hotel-city-tag">${hotel.city}</div>
                            <h3>${hotel.name}</h3>
                            <div class="hotel-meta-grid">
                                <div class="meta-item">
                                    <div class="meta-label">Звёзды</div>
                                    <div class="meta-value">${getStars(hotel.stars)}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Рейтинг</div>
                                    <div class="meta-value">${hotel.rating}/10</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Расстояние</div>
                                    <div class="meta-value">${hotel.distance}</div>
                                </div>
                            </div>
                        </div>
                        <div class="hotel-images-stack">
                            ${photoHtml || '<div style="background: #ddd; grid-column: 1/-1; height: 300px;"></div>'}
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-cell">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-cell">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-swiss">
                    <div class="header-grid">
                        <div class="header-left">
                            ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                            <h1 class="brand-name">${state.brandName}</h1>
                            <p class="tagline">${state.tagline}</p>
                        </div>
                        <div class="header-right">
                            <h2 class="package-title">${state.packageTitle}</h2>
                            <p class="package-subtitle">${state.packageSubtitle}</p>
                        </div>
                    </div>
                    
                    <div class="main-content">
                        <div class="section-label">Accommodation</div>
                        <h3 class="section-title">Премиум отели</h3>
                        <div class="hotels-list">${hotels}</div>
                        
                        <div class="prices-module">
                            <div class="section-label">Pricing</div>
                            <h3 class="section-title">Стоимость пакетов</h3>
                            <div class="prices-table">${prices}</div>
                        </div>
                        
                        <div class="section-label">Services</div>
                        <h3 class="section-title">Включённые услуги</h3>
                        <div class="services-matrix">${services}</div>
                    </div>
                </div>
            `;
        }
        
        // NEW: Desert Classic Template
        function renderDesertClassic() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-ornate">
                        <div class="hotel-header">
                            <div class="hotel-city-ornate">${hotel.city}</div>
                            <h3 class="hotel-name">${hotel.name}</h3>
                        </div>
                        <div class="hotel-photos-ornate">
                            ${photoHtml || '<div style="background: #e0e0e0; grid-column: 1/-1; height: 220px; border-radius: 12px;"></div>'}
                        </div>
                        <div class="hotel-meta-ornate">
                            <span>${getStars(hotel.stars)}</span>
                            <span>⭐ ${hotel.rating}</span>
                            <span>📍 ${hotel.distance}</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-ornate">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-box">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            const transfer = state.transfer.map(item => `
                <div class="transfer-box">
                    <div class="icon">${item.icon}</div>
                    <h4>${item.title}</h4>
                    <p>${item.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-desert">
                    <div class="header-ornate">
                        ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                        <h1 class="brand-name">${state.brandName}</h1>
                        <p class="tagline">${state.tagline}</p>
                    </div>
                    
                    <h2 class="package-title">${state.packageTitle}</h2>
                    <p class="package-subtitle">${state.packageSubtitle}</p>
                    
                    <div class="section-divider">◆◆◆</div>
                    
                    <h3 class="section-heading">Отели</h3>
                    <div class="hotels-container">${hotels}</div>
                    
                    <div class="section-divider">◆◆◆</div>
                    
                    <div class="prices-ornate">
                        <h3 class="section-heading">Стоимость</h3>
                        <div class="prices-grid">${prices}</div>
                    </div>
                    
                    <h3 class="section-heading">Включённые услуги</h3>
                    <div class="services-ornate">${services}</div>
                    
                    <div class="section-divider">◆◆◆</div>
                    
                  
                </div>
            `;
        }
        
        // NEW: Kazakh Ornate Template
        function renderKazakhOrnate() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-kazakh">
                        <div class="hotel-kazakh-header">
                            <div class="hotel-city-kazakh">${hotel.city}</div>
                            <h3 class="hotel-name-kazakh">${hotel.name}</h3>
                        </div>
                        <div class="hotel-body">
                            <div class="hotel-photos-kazakh">
                                ${photoHtml || '<div style="background: #333; grid-column: 1/-1; height: 260px; border-radius: 12px;"></div>'}
                            </div>
                            <div class="hotel-meta-kazakh">
                                <span>${getStars(hotel.stars)}</span>
                                <span>⭐ ${hotel.rating}</span>
                                <span>📍 ${hotel.distance}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-kazakh">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-kazakh">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            const transfer = state.transfer.map(item => `
                <div class="transfer-kazakh">
                    <div class="icon">${item.icon}</div>
                    <h4>${item.title}</h4>
                    <p>${item.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-kazakh">
                    <div class="hero-kazakh">
                        <div class="ornament-top">◆◆◆◆◆</div>
                        ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                        <h1 class="brand-name">${state.brandName}</h1>
                        <p class="tagline">${state.tagline}</p>
                    </div>
                    
                    <div class="title-section">
                        <h2 class="package-title">${state.packageTitle}</h2>
                        <p class="package-subtitle">${state.packageSubtitle}</p>
                    </div>
                    
                    <div class="content-kazakh">
                        <h3 class="section-title-kazakh">Размещение</h3>
                        <div class="hotels-kazakh">${hotels}</div>
                        
                        <div class="ornament-divider">◆ ◆ ◆</div>
                        
                        <div class="prices-kazakh">
                            <h3 class="section-title-kazakh">Стоимость пакетов</h3>
                            <div class="prices-grid-kazakh">${prices}</div>
                        </div>
                        
                        <h3 class="section-title-kazakh">Включённые услуги</h3>
                        <div class="services-grid-kazakh">${services}</div>
                        
                        <div class="ornament-divider">◆ ◆ ◆</div>
                        
               
                    </div>
                </div>
            `;
        }
        
        // NEW: Ultra Modern Grid Template
        function renderUltraModernGrid() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-ultra">
                        <div class="hotel-info-ultra">
                            <div class="hotel-city-ultra">${hotel.city}</div>
                            <h3 class="hotel-name-ultra">${hotel.name}</h3>
                            <div class="hotel-stats-ultra">
                                <div class="stat-ultra">
                                    <span class="stat-label">Stars</span>
                                    <span class="stat-value">${getStars(hotel.stars)}</span>
                                </div>
                                <div class="stat-ultra">
                                    <span class="stat-label">Rating</span>
                                    <span class="stat-value">${hotel.rating}</span>
                                </div>
                                <div class="stat-ultra">
                                    <span class="stat-label">Distance</span>
                                    <span class="stat-value">${hotel.distance}</span>
                                </div>
                            </div>
                        </div>
                        <div class="hotel-photos-ultra">
                            ${photoHtml || '<div style="background: #ddd; grid-column: 1/-1; height: 200px;"></div>'}
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-ultra">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-ultra">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            const transfer = state.transfer.map(item => `
                <div class="transfer-item-ultra">
                    <div class="icon">${item.icon}</div>
                    <h4>${item.title}</h4>
                    <p>${item.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-ultra">
                    <div class="grid-container">
                        <div class="header-ultra">
                            <div class="logo-col">
                                ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                            </div>
                            <div class="brand-col">
                                <h1 class="brand-name">${state.brandName}</h1>
                                <p class="tagline">${state.tagline}</p>
                            </div>
                            <div class="title-col">
                                <h2 class="package-title">${state.packageTitle}</h2>
                                <p class="package-subtitle">${state.packageSubtitle}</p>
                            </div>
                        </div>
                        
                        <div class="section-label-ultra">Hotels</div>
                        <div class="section-content-ultra">
                            <h3 class="section-title-ultra">Accommodation</h3>
                            <div class="hotels-ultra">${hotels}</div>
                        </div>
                        
                        <div class="section-label-ultra">Pricing</div>
                        <div class="section-content-ultra">
                            <h3 class="section-title-ultra">Package Rates</h3>
                            <div class="prices-ultra">${prices}</div>
                        </div>
                        
                        <div class="section-label-ultra">Services</div>
                        <div class="section-content-ultra">
                            <h3 class="section-title-ultra">Included Services</h3>
                            <div class="services-ultra">${services}</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // NEW: Apple Glassmorphism Template
        function renderAppleGlassmorphism() {
            const hotels = state.hotels.map(hotel => {
                const photoHtml = hotel.photos.slice(0, 3).map(url => 
                    `<img src="${sanitizeUrl(url)}" alt="${hotel.name}" crossorigin="anonymous">`
                ).join('');
                
                return `
                    <div class="hotel-glass">
                        <div class="hotel-photos-glass">
                            ${photoHtml || '<div style="background: rgba(255,255,255,0.2); grid-column: 1/-1;"></div>'}
                        </div>
                        <div class="hotel-info-glass">
                            <div class="hotel-city-glass">${hotel.city}</div>
                            <h3 class="hotel-name-glass">${hotel.name}</h3>
                            <div class="hotel-meta-glass">
                                <span>${getStars(hotel.stars)}</span>
                                <span>⭐ ${hotel.rating}</span>
                                <span>📍 ${hotel.distance}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const prices = state.prices.map(price => `
                <div class="price-glass">
                    <div class="label">${price.label}</div>
                    <div class="value">${price.value}</div>
                </div>
            `).join('');
            
            const services = state.services.map(service => `
                <div class="service-glass">
                    <div class="icon">${service.icon}</div>
                    <h4>${service.title}</h4>
                    <p>${service.desc}</p>
                </div>
            `).join('');
            
            const transfer = state.transfer.map(item => `
                <div class="transfer-item-glass">
                    <div class="icon">${item.icon}</div>
                    <h4>${item.title}</h4>
                    <p>${item.desc}</p>
                </div>
            `).join('');
            
            return `
                <div class="template-glass">
                    <div class="glass-header">
                        ${state.logo ? `<img src="${state.logo}" alt="Logo" class="logo" crossorigin="anonymous">` : ''}
                        <h1 class="brand-name">${state.brandName}</h1>
                        <p class="tagline">${state.tagline}</p>
                    </div>
                    
                    <div class="glass-title">
                        <h2 class="package-title">${state.packageTitle}</h2>
                        <p class="package-subtitle">${state.packageSubtitle}</p>
                    </div>
                    
                    <h3 class="section-heading-glass">Отели</h3>
                    <div class="hotels-glass">${hotels}</div>
                    
                    <h3 class="section-heading-glass">Цены</h3>
                    <div class="prices-glass">${prices}</div>
                    
                    <h3 class="section-heading-glass">Услуги</h3>
                    <div class="services-glass">${services}</div>
                </div>
            `;
        }
        
        function render() {
            const sheet = document.getElementById('previewSheet');
            
            switch (state.template) {
                case 'apple-minimalist':
                    sheet.innerHTML = renderAppleMinimalist();
                    break;
                case 'magazine-editorial':
                    sheet.innerHTML = renderMagazineEditorial();
                    break;
                case 'brutalist-luxury':
                    sheet.innerHTML = renderBrutalistLuxury();
                    break;
                case 'swiss-modern':
                    sheet.innerHTML = renderSwissModern();
                    break;
                // NEW: 4 additional templates
                case 'desert-classic':
                    sheet.innerHTML = renderDesertClassic();
                    break;
                case 'kazakh-ornate':
                    sheet.innerHTML = renderKazakhOrnate();
                    break;
                case 'ultra-modern-grid':
                    sheet.innerHTML = renderUltraModernGrid();
                    break;
                case 'apple-glassmorphism':
                    sheet.innerHTML = renderAppleGlassmorphism();
                    break;
            }
        }
        
        // === EDITOR UI ===
        function renderHotelsList() {
            const list = document.getElementById('hotelsList');
            list.innerHTML = state.hotels.map((hotel, idx) => `
                <div class="list-item">
                    <div class="list-item-header">
                        <span class="list-item-title">Отель ${idx + 1}</span>
                        <button class="btn btn-icon btn-delete" onclick="removeHotel(${idx})">🗑️</button>
                    </div>
                    <div class="form-group">
                        <label>Город</label>
                        <input type="text" value="${hotel.city}" oninput="updateHotel(${idx}, 'city', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Название</label>
                        <input type="text" value="${hotel.name}" oninput="updateHotel(${idx}, 'name', this.value)">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Звёзды</label>
                            <input type="number" min="1" max="5" value="${hotel.stars}" oninput="updateHotel(${idx}, 'stars', parseInt(this.value))">
                        </div>
                        <div class="form-group">
                            <label>Рейтинг</label>
                            <input type="number" step="0.1" value="${hotel.rating}" oninput="updateHotel(${idx}, 'rating', parseFloat(this.value))">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Расстояние</label>
                        <input type="text" value="${hotel.distance}" oninput="updateHotel(${idx}, 'distance', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Фото 1 (URL)</label>
                        <input type="url" value="${hotel.photos[0] || ''}" oninput="updateHotelPhoto(${idx}, 0, this.value)">
                    </div>
                    <div class="form-group">
                        <label>Фото 2 (URL)</label>
                        <input type="url" value="${hotel.photos[1] || ''}" oninput="updateHotelPhoto(${idx}, 1, this.value)">
                    </div>
                    <div class="form-group">
                        <label>Фото 3 (URL)</label>
                        <input type="url" value="${hotel.photos[2] || ''}" oninput="updateHotelPhoto(${idx}, 2, this.value)">
                    </div>
                </div>
            `).join('');
        }
        
        function renderPricesList() {
            const list = document.getElementById('pricesList');
            list.innerHTML = state.prices.map((price, idx) => `
                <div class="list-item">
                    <div class="list-item-header">
                        <span class="list-item-title">Цена ${idx + 1}</span>
                        <button class="btn btn-icon btn-delete" onclick="removePrice(${idx})">🗑️</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Название</label>
                            <input type="text" value="${price.label}" oninput="updatePrice(${idx}, 'label', this.value)">
                        </div>
                        <div class="form-group">
                            <label>Стоимость</label>
                            <input type="text" value="${price.value}" oninput="updatePrice(${idx}, 'value', this.value)">
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function renderServicesList() {
            const list = document.getElementById('servicesList');
            list.innerHTML = state.services.map((service, idx) => `
                <div class="list-item">
                    <div class="list-item-header">
                        <span class="list-item-title">Услуга ${idx + 1}</span>
                        <button class="btn btn-icon btn-delete" onclick="removeService(${idx})">🗑️</button>
                    </div>
                    <div class="form-group">
                        <label>Иконка (emoji)</label>
                        <input type="text" value="${service.icon}" oninput="updateService(${idx}, 'icon', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Название</label>
                        <input type="text" value="${service.title}" oninput="updateService(${idx}, 'title', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Описание</label>
                        <input type="text" value="${service.desc}" oninput="updateService(${idx}, 'desc', this.value)">
                    </div>
                </div>
            `).join('');
        }
        
        // NEW: Transfer List Renderer
        function renderTransferList() {
            const list = document.getElementById('transferList');
            list.innerHTML = state.transfer.map((item, idx) => `
                <div class="list-item">
                    <div class="list-item-header">
                        <span class="list-item-title">Трансфер ${idx + 1}</span>
                        <button class="btn btn-icon btn-delete" onclick="removeTransfer(${idx})">🗑️</button>
                    </div>
                    <div class="form-group">
                        <label>Иконка (emoji)</label>
                        <input type="text" value="${item.icon}" oninput="updateTransfer(${idx}, 'icon', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Название</label>
                        <input type="text" value="${item.title}" oninput="updateTransfer(${idx}, 'title', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Описание</label>
                        <input type="text" value="${item.desc}" oninput="updateTransfer(${idx}, 'desc', this.value)">
                    </div>
                </div>
            `).join('');
        }
        
        function updateHotel(idx, field, value) {
            state.hotels[idx][field] = value;
            render();
        }
        
        function updateHotelPhoto(idx, photoIdx, value) {
            state.hotels[idx].photos[photoIdx] = value;
            render();
        }
        
        function updatePrice(idx, field, value) {
            state.prices[idx][field] = value;
            render();
        }
        
        function updateService(idx, field, value) {
            state.services[idx][field] = value;
            render();
        }
        
        function removeHotel(idx) {
            state.hotels.splice(idx, 1);
            renderHotelsList();
            render();
        }
        
        function removePrice(idx) {
            state.prices.splice(idx, 1);
            renderPricesList();
            render();
        }
        
        function removeService(idx) {
            state.services.splice(idx, 1);
            renderServicesList();
            render();
        }
        
        // NEW: Transfer Update/Remove Functions
        function updateTransfer(idx, field, value) {
            state.transfer[idx][field] = value;
            render();
        }
        
        function removeTransfer(idx) {
            state.transfer.splice(idx, 1);
            renderTransferList();
            render();
        }
        
        // === PDF EXPORT ===
        // NEW: Updated to export as single long page in px units
        async function exportSinglePagePDF() {
            const overlay = document.getElementById('loadingOverlay');
            overlay.classList.add('active');
            
            try {
                // Дождаться загрузки шрифтов
                await document.fonts.ready;
                await new Promise(r => setTimeout(r, 500));
                
                const sheet = document.getElementById('previewSheet');
                const bg = getComputedStyle(sheet).backgroundColor || '#ffffff';
                
                // Создать canvas с html2canvas
                const canvas = await html2canvas(sheet, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: bg,
                    logging: false,
                    windowWidth: document.documentElement.scrollWidth
                });
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const { jsPDF } = window.jspdf;
                
                // КРИТИЧЕСКИ ВАЖНО: единицы px, формат = размер canvas
                // Это создаёт ОДИН лист произвольной высоты
                const pdf = new jsPDF({
                    orientation: 'p',
                    unit: 'px',
                    format: [canvas.width, canvas.height],
                    compress: true,
                    hotfixes: []
                });
                
                // Вставить изображение один раз на позицию (0,0)
                pdf.addImage(imgData, 'JPEG', 0, 0, canvas.width, canvas.height, undefined, 'FAST');
                
                // Сохранить файл
                pdf.save(`${state.brandName}_${state.template}_${Date.now()}.pdf`);
                
                showToast('PDF успешно создан!', 'success');
            } catch (e) {
                console.error('Ошибка PDF экспорта:', e);
                showToast('Ошибка создания PDF', 'error');
            } finally {
                overlay.classList.remove('active');
            }
        }
        
        // === EVENT LISTENERS ===
        document.addEventListener('DOMContentLoaded', () => {
            // Branding inputs
            document.getElementById('brandName').addEventListener('input', (e) => {
                state.brandName = e.target.value;
                render();
            });
            
            document.getElementById('tagline').addEventListener('input', (e) => {
                state.tagline = e.target.value;
                render();
            });
            
            document.getElementById('packageTitle').addEventListener('input', (e) => {
                state.packageTitle = e.target.value;
                render();
            });
            
            document.getElementById('packageSubtitle').addEventListener('input', (e) => {
                state.packageSubtitle = e.target.value;
                render();
            });
            
            // Logo upload
            document.getElementById('logoUpload').addEventListener('click', () => {
                document.getElementById('logoInput').click();
            });
            
            document.getElementById('logoInput').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        state.logo = event.target.result;
                        document.getElementById('logoPreview').style.display = 'flex';
                        document.getElementById('logoPreviewImg').src = state.logo;
                        render();
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            document.getElementById('logoRemove').addEventListener('click', () => {
                state.logo = null;
                document.getElementById('logoPreview').style.display = 'none';
                document.getElementById('logoInput').value = '';
                render();
            });
            
            // Template selector
            document.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.template-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                    state.template = card.dataset.template;
                    render();
                });
            });
            
            // Add buttons
            document.getElementById('addHotel').addEventListener('click', () => {
                state.hotels.push({
                    city: 'Новый город',
                    name: 'Новый отель',
                    stars: 5,
                    rating: 9.0,
                    distance: '500м',
                    photos: ['', '', '']
                });
                renderHotelsList();
                render();
            });
            
            document.getElementById('addPrice').addEventListener('click', () => {
                state.prices.push({ label: 'Новая цена', value: '$0' });
                renderPricesList();
                render();
            });
            
            document.getElementById('addService').addEventListener('click', () => {
                state.services.push({ icon: '🎯', title: 'Новая услуга', desc: 'Описание' });
                renderServicesList();
                render();
            });
            
            // NEW: Add Transfer button handler
            document.getElementById('addTransfer').addEventListener('click', () => {
                state.transfer.push({ icon: '🚗', title: 'Новый трансфер', desc: 'Описание' });
                renderTransferList();
                render();
            });
            
            // Actions
            document.getElementById('exportPDF').addEventListener('click', exportSinglePagePDF);
            
            document.getElementById('printBtn').addEventListener('click', () => {
                window.print();
            });
            
            document.getElementById('saveJSON').addEventListener('click', () => {
                const json = JSON.stringify(state, null, 2);
                const blob = new Blob([json], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `atlas_package_${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showToast('Конфигурация сохранена', 'success');
            });
            
            document.getElementById('loadJSON').addEventListener('click', () => {
                document.getElementById('jsonInput').click();
            });
            
            document.getElementById('jsonInput').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const loaded = JSON.parse(event.target.result);
                            // NEW: Ensure transfer field exists for backward compatibility
                            if (!loaded.transfer) {
                                loaded.transfer = [];
                            }
                            state = { ...state, ...loaded };
                            
                            // Update form fields
                            document.getElementById('brandName').value = state.brandName;
                            document.getElementById('tagline').value = state.tagline;
                            document.getElementById('packageTitle').value = state.packageTitle;
                            document.getElementById('packageSubtitle').value = state.packageSubtitle;
                            
                            // Update template
                            document.querySelectorAll('.template-card').forEach(c => c.classList.remove('active'));
                            document.querySelector(`[data-template="${state.template}"]`).classList.add('active');
                            
                            // Update logo
                            if (state.logo) {
                                document.getElementById('logoPreview').style.display = 'flex';
                                document.getElementById('logoPreviewImg').src = state.logo;
                            }
                            
                            renderHotelsList();
                            renderPricesList();
                            renderServicesList();
                            renderTransferList(); // NEW
                            render();
                            
                            showToast('Конфигурация загружена', 'success');
                        } catch (err) {
                            showToast('Ошибка загрузки файла', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            });
            
            // Initial render
            renderHotelsList();
            renderPricesList();
            renderServicesList();
            renderTransferList(); // NEW
            render();
        });
    </script>
</body>
</html>